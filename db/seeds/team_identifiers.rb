leagues = League.where(code: %w[mlb nfl ncaaf ncaam]).index_by(&:code)
sources = DataSource.where(code: %w[sportsline mlb_api roto_wire espn barttorvik ken_pom]).index_by(&:code)

shared_sportsline_overrides = {
  "ALAM" => "AAMU",
  "ABIL" => "ACU",
  "AF" => "AFA",
  "AKRON" => "AKR",
  "ALBANY" => "ALBNY",
  "APLST" => "APP",
  "ARKST" => "ARST",
  "ARIZST" => "ASU",
  "AUBURN" => "AUB",
  "BALLST" => "BALL",
  "BAYLOR" => "BAY",
  "BELLAR" => "BELL",
  "BELMONT" => "BELM",
  "BGREEN" => "BGSU",
  "BROWN" => "BRWN",
  "BRYANT" => "BRY",
  "BOISE" => "BSU",
  "BUTLER" => "BUT",
  "CALBPTST" => "CABP",
  "CAN" => "CANI",
  "UCRIV" => "CARIV",
  "UCSB" => "CASB",
  "CSN" => "CASTN",
  "CSFULL" => "CASTF",
  "CSTCAR" => "CCAR",
  "CHARLO" => "CHAR",
  "TNCHAT" => "CHAT",
  "CHARSO" => "CHSO",
  "CHIST" => "CHSU",
  "CINCY" => "CIN",
  "CLEVST" => "CLEV",
  "CMICH" => "CMU",
  "CHARLS" => "COC",
  "UCONN" => "CONN",
  "BTHU" => "COOK",
  "COPPST" => "COPP",
  "CORN" => "COR",
  "CPOLY" => "CP",
  "CREIGH" => "CREIG",
  "COLOST" => "CSU",
  "CSBAK" => "CSUB",
  "DAVID" => "DAV",
  "DAYTON" => "DAY",
  "DE" => "DEL",
  "DENVER" => "DEN",
  "DTROIT" => "DET",
  "DEPAUL" => "DPAUL",
  "DREXEL" => "DREXL",
  "DRAKE" => "DRKE",
  "DELST" => "DSU",
  "EILL" => "EIU",
  "EMICH" => "EMU",
  "TAMC" => "ETAM",
  "EWASH" => "EWU",
  "FORD" => "FOR",
  "FURMAN" => "FUR",
  "FRESNO" => "FRES",
  "GAS" => "GASO",
  "GC" => "GCU",
  "GMASON" => "GMU",
  "GONZAG" => "GONZ",
  "GATECH" => "GT",
  "GTOWN" => "GTWN",
  "GWASH" => "GW",
  "HAWAII" => "HAW",
  "HOLY" => "HC",
  "HOFSTRA" => "HOF",
  "HIGHPT" => "HP",
  "IDAHO" => "IDHO",
  "INDST" => "INST",
  "IOWAST" => "ISU",
  "JVILLE" => "JAC",
  "JACKST" => "JKST",
  "JMAD" => "JMU",
  "JAXST" => "JVST",
  "KENTST" => "KENT",
  "KSTATE" => "KSU",
  "KENSAW" => "KSW",
  "KANSAS" => "KU",
  "LAMAR" => "LAM",
  "LSALLE" => "LASAL",
  "LNGBCH" => "LBS",
  "LEHIGH" => "LEH",
  "LPSCMB" => "LIPS",
  "LEMOYN" => "LMC",
  "LONGWD" => "LONG",
  "LVILLE" => "LOU",
  "LOYCHI" => "LOYIL",
  "LOYMRY" => "LOYMR",
  "LATECH" => "LT",
  "LOYMD" => "LUMD",
  "LINDEN" => "Linden",
  "MIAOH" => "M-OH",
  "MERMAK" => "MACK",
  "MARQET" => "MARQ",
  "MCNSE" => "MCNS",
  "MERCER" => "MER",
  "MERCYH" => "MHRT",
  "MIAMI" => "MIA",
  "MIZZOU" => "MIZZ",
  "MAINE" => "MNE",
  "UMKC" => "MOKC",
  "MNTNA" => "MONT",
  "MOREHD" => "MORE",
  "MORGAN" => "MORG",
  "MARIST" => "MRST",
  "MISSST" => "MSST",
  "MICHST" => "MSU",
  "MONST" => "MTST",
  "MOUNT" => "MTSTM",
  "NAL" => "NA",
  "NCCEN" => "NCCU",
  "NDAKST" => "NDSU",
  "NEAST" => "NEAS",
  "NEBOM" => "NEOM",
  "NEVADA" => "NEV",
  "NICHST" => "NICH",
  "NILL" => "NIU",
  "NJTECH" => "NJIT",
  "NKY" => "NKU",
  "NMEXST" => "NMSU",
  "NWEST" => "NW",
  "OAK" => "OAKD",
  "OKLAST" => "OKST",
  "OREG" => "ORE",
  "OREGST" => "ORST",
  "OHIOST" => "OSU",
  "UOP" => "PAC",
  "AP" => "PEAY",
  "PEPPER" => "PEPP",
  "IPFW" => "PFW",
  "PRESBY" => "PRES",
  "PRINCE" => "PRIN",
  "PORTST" => "PRST",
  "PURDUE" => "PUR",
  "QUEENC" => "QNNC",
  "QUINN" => "QPAC",
  "RADFRD" => "RADF",
  "RIDER" => "RDER",
  "ROB" => "RMU",
  "RUT" => "RUTG",
  "SACST" => "SAC",
  "SNCLRA" => "SC",
  "SC" => "SCAR",
  "SDAKST" => "SDKS",
  "SDGST" => "SDSU",
  "SELOU" => "SELA",
  "SEMOST" => "SEMO",
  "SANFRAN" => "SF",
  "STRFPA" => "SFU",
  "SETON" => "SH",
  "SAMST" => "SHSU",
  "SACHRT" => "SHU",
  "SIENA" => "SIEN",
  "SIL" => "SIU",
  "STJOES" => "SJPA",
  "SJST" => "SJSU",
  "STJOHN" => "SJU",
  "SOINDI" => "SOIN",
  "STNFRD" => "STAN",
  "STETSON" => "STET",
  "MARYCA" => "STMCA",
  "STTHMN" => "STMN",
  "STONH" => "STNH",
  "STONYBRK" => "STON",
  "STPETE" => "STPE",
  "SEATTLE" => "STTL",
  "SUTAH" => "SUU",
  "CUSE" => "SYR",
  "TXAM" => "TAMU",
  "TRLST" => "TAR",
  "TEMPLE" => "TEM",
  "TEXAS" => "TEX",
  "TULSA" => "TLSA",
  "TNTECH" => "TNTC",
  "TOLEDO" => "TOL",
  "TEXPA" => "TRGV",
  "TXTECH" => "TTU",
  "TULANE" => "TULN",
  "TXAMCC" => "TXACC",
  "TEXSO" => "TXSO",
  "TXSTSM" => "TXST",
  "ARKLR" => "UALR",
  "CAR" => "UCA",
  "DAVIS" => "UCD",
  "UCIRV" => "UCI",
  "CALSD" => "UCSD",
  "ILLCHI" => "UIC",
  "LAMON" => "ULM",
  "MD" => "UMD",
  "MASLOW" => "UMLW",
  "NCASHV" => "UNCA",
  "NCGRN" => "UNCG",
  "NCWILM" => "UNCW",
  "NCOLO" => "UNCO",
  "NDAK" => "UND",
  "UNF" => "UNFL",
  "NHAV" => "UNH",
  "NIOWA" => "UNI",
  "NMEX" => "UNM",
  "NORL" => "UNO",
  "NTEXAS" => "UNT",
  "RI" => "URI",
  "SALA" => "USA",
  "USCUP" => "USCU",
  "SFLA" => "USF",
  "UTAHST" => "USU",
  "TNMART" => "UTM",
  "TXSA" => "UTSA",
  "UTVALL" => "UVSU",
  "WISGB" => "UWGB",
  "MILW" => "UWM",
  "VALPO" => "VALP",
  "VANDY" => "VAN",
  "UVM" => "VRMT",
  "VATECH" => "VT",
  "WAGNER" => "WAG",
  "WICHST" => "WCHST",
  "WCAR" => "WCU",
  "WBRST" => "WEB",
  "GWEBB" => "WEBB",
  "WESTGA" => "WEGA",
  "WINTHR" => "WINT",
  "WISC" => "WIS",
  "WIL" => "WIU",
  "WKY" => "WKU",
  "WMMARY" => "WMRY",
  "WMICH" => "WMU",
  "WOFF" => "WOF",
  "WRIGHT" => "WRIG",
  "WASHST" => "WSU",
  "XAVIER" => "XAV"
}

shared_espn_overrides = {
  "AF" => "AFA",
  "UALB" => "ALBNY",
  "UAPB" => "ARPB",
  "ALA" => "BAMA",
  "BEL" => "BELM",
  "BOIS" => "BSU",
  "BUF" => "BUFF",
  "CBU" => "CABP",
  "CAM" => "CAMP",
  "CAN" => "CANI",
  "UCR" => "CARIV",
  "UCSB" => "CASB",
  "CSUF" => "CASTF",
  "CSUN" => "CASTN",
  "CCU" => "CCAR",
  "CCSU" => "CCTST",
  "CLT" => "CHAR",
  "UTC" => "CHAT",
  "CHST" => "CHSU",
  "CLE" => "CLEV",
  "COLU" => "CLMB",
  "COFC" => "COC",
  "BCU" => "COOK",
  "CREI" => "CREIG",
  "DETM" => "DET",
  "DEP" => "DPAUL",
  "DREX" => "DREXL",
  "EKU" => "EKY",
  "ETSU" => "ETNST",
  "HPU" => "HP",
  "IU" => "IND",
  "IUIN" => "IUI",
  "UIW" => "IW",
  "JAX" => "JAC",
  "JXST" => "JVST",
  "KENN" => "KSW",
  "UL" => "LA",
  "LAS" => "LASAL",
  "LBSU" => "LBS",
  "LIN" => "Linden",
  "LIP" => "LIPS",
  "LEM" => "LMC",
  "LUC" => "LOYIL",
  "LMU" => "LOYMR",
  "L-MD" => "LUMD",
  "MRMK" => "MACK",
  "MAN" => "MANH",
  "MCN" => "MCNS",
  "MERC" => "MHRT",
  "ME" => "MNE",
  "MIZ" => "MIZZ",
  "KC" => "MOKC",
  "MSM" => "MTSTM",
  "MUR" => "MURR",
  "UNA" => "NA",
  "NCSU" => "NCST",
  "NE" => "NEAS",
  "OMA" => "NEOM",
  "NIA" => "NIAG",
  "VILL" => "NOVA",
  "NU" => "NW",
  "OAK" => "OAKD",
  "OU" => "OKLA",
  "ORU" => "ORAL",
  "APSU" => "PEAY",
  "PV" => "PVAM",
  "QUC" => "QNNC",
  "QUIN" => "QPAC",
  "RAD" => "RADF",
  "RID" => "RDER",
  "SCU" => "SC",
  "SC" => "SCAR",
  "SDST" => "SDKS",
  "SFPA" => "SFU",
  "HALL" => "SH",
  "SIE" => "SIEN",
  "JOES" => "SJPA",
  "USI" => "SOIN",
  "SBU" => "STBON",
  "SLU" => "STLOU",
  "SMC" => "STMCA",
  "STO" => "STNH",
  "STBK" => "STON",
  "SPU" => "STPE",
  "SEA" => "STTL",
  "TA&M" => "TAMU",
  "TOW" => "TOWS",
  "RGV" => "TRGV",
  "AMCC" => "TXACC",
  "UTA" => "TXARL",
  "LR" => "UALR",
  "CARK" => "UCA",
  "MASS" => "UMASS",
  "MD" => "UMD",
  "UML" => "UMLW",
  "UNF" => "UNFL",
  "NHVN" => "UNHV",
  "UPST" => "USCU",
  "UVU" => "UVSU",
  "GB" => "UWGB",
  "MILW" => "UWM",
  "VAL" => "VALP",
  "UVM" => "VRMT",
  "GWEB" => "WEBB",
  "WGA" => "WEGA",
  "WICH" => "WCHST",
  "WIN" => "WINT",
  "W&M" => "WMRY",
  "WRST" => "WRIG",
}

barttorvik_overrides = {
  "Alabama A&M" => "AAMU",
  "Abilene Christian" => "ACU",
  "Air Force" => "AFA",
  "Akron" => "AKR",
  "Albany" => "ALBNY",
  "Alcorn St." => "ALCN",
  "Alabama St." => "ALST",
  "American" => "AMER",
  "Appalachian St." => "APP",
  "Arizona" => "ARIZ",
  "Arkansas" => "ARK",
  "Army" => "ARMY",
  "Arkansas Pine Bluff" => "ARPB",
  "Arkansas St." => "ARST",
  "Arizona St." => "ASU",
  "Auburn" => "AUB",
  "Ball St." => "BALL",
  "Alabama" => "BAMA",
  "Baylor" => "BAY",
  "Boston College" => "BC",
  "Bellarmine" => "BELL",
  "Belmont" => "BELM",
  "Bowling Green" => "BGSU",
  "Binghamton" => "BING",
  "Bradley" => "BRAD",
  "Brown" => "BRWN",
  "Bryant" => "BRY",
  "Boise St." => "BSU",
  "Boston University" => "BU",
  "Bucknell" => "BUCK",
  "Buffalo" => "BUFF",
  "Butler" => "BUT",
  "BYU" => "BYU",
  "Cal Baptist" => "CABP",
  "California" => "CAL",
  "Campbell" => "CAMP",
  "Canisius" => "CANI",
  "UC Riverside" => "CARIV",
  "UC Santa Barbara" => "CASB",
  "Cal St. Fullerton" => "CASTF",
  "Cal St. Northridge" => "CASTN",
  "Coastal Carolina" => "CCAR",
  "Central Connecticut" => "CCTST",
  "Charlotte" => "CHAR",
  "Chattanooga" => "CHAT",
  "Charleston Southern" => "CHSO",
  "Chicago St." => "CHSU",
  "Cincinnati" => "CIN",
  "The Citadel" => "CIT",
  "Clemson" => "CLEM",
  "Cleveland St." => "CLEV",
  "Columbia" => "CLMB",
  "Central Michigan" => "CMU",
  "Charleston" => "COC",
  "Colgate" => "COLG",
  "Colorado" => "COLO",
  "Connecticut" => "CONN",
  "Bethune Cookman" => "COOK",
  "Coppin St." => "COPP",
  "Cornell" => "COR",
  "Cal Poly" => "CP",
  "Creighton" => "CREIG",
  "Colorado St." => "CSU",
  "Cal St. Bakersfield" => "CSUB",
  "Dartmouth" => "DART",
  "Davidson" => "DAV",
  "Dayton" => "DAY",
  "Delaware" => "DEL",
  "Denver" => "DEN",
  "Detroit Mercy" => "DET",
  "DePaul" => "DPAUL",
  "Drexel" => "DREXL",
  "Drake" => "DRKE",
  "Delaware St." => "DSU",
  "Duke" => "DUKE",
  "Duquesne" => "DUQ",
  "East Carolina" => "ECU",
  "Eastern Illinois" => "EIU",
  "Eastern Kentucky" => "EKY",
  "Elon" => "ELON",
  "Eastern Michigan" => "EMU",
  "East Texas A&M" => "ETAM",
  "East Tennessee St." => "ETNST",
  "Evansville" => "EVAN",
  "Eastern Washington" => "EWU",
  "Fairfield" => "FAIR",
  "Florida A&M" => "FAMU",
  "Florida Atlantic" => "FAU",
  "Fairleigh Dickinson" => "FDU",
  "Florida Gulf Coast" => "FGCU",
  "FIU" => "FIU",
  "Florida" => "FLA",
  "Fordham" => "FOR",
  "Fresno St." => "FRES",
  "Florida St." => "FSU",
  "Furman" => "FUR",
  "Georgia Southern" => "GASO",
  "Georgia St." => "GAST",
  "Grand Canyon" => "GCU",
  "George Mason" => "GMU",
  "Gonzaga" => "GONZ",
  "Grambling St." => "GRAM",
  "Georgia Tech" => "GT",
  "Georgetown" => "GTWN",
  "George Washington" => "GW",
  "Hampton" => "HAMP",
  "Harvard" => "HARV",
  "Hawaii" => "HAW",
  "Holy Cross" => "HC",
  "Houston Christian" => "HCU",
  "Hofstra" => "HOF",
  "Houston" => "HOU",
  "Howard" => "HOW",
  "High Point" => "HP",
  "Idaho" => "IDHO",
  "Idaho St." => "IDST",
  "Illinois" => "ILL",
  "Illinois St." => "ILST",
  "Indiana" => "IND",
  "Indiana St." => "INST",
  "Iona" => "IONA",
  "Iowa" => "IOWA",
  "Iowa St." => "ISU",
  "IU Indy" => "IUI",
  "Incarnate Word" => "IW",
  "Jacksonville" => "JAC",
  "Jackson St." => "JKST",
  "James Madison" => "JMU",
  "Jacksonville St." => "JVST",
  "Kent St." => "KENT",
  "Kansas St." => "KSU",
  "Kennesaw St." => "KSW",
  "Kansas" => "KU",
  "Louisiana" => "LA",
  "Lafayette" => "LAF",
  "Lamar" => "LAM",
  "La Salle" => "LASAL",
  "Long Beach St." => "LBS",
  "Lehigh" => "LEH",
  "Liberty" => "LIB",
  "Lindenwood" => "Linden",
  "Lipscomb" => "LIPS",
  "LIU" => "LIU",
  "Le Moyne" => "LMC",
  "Longwood" => "LONG",
  "Louisville" => "LOU",
  "Loyola Chicago" => "LOYIL",
  "Loyola Marymount" => "LOYMR",
  "LSU" => "LSU",
  "Louisiana Tech" => "LT",
  "Loyola MD" => "LUMD",
  "Miami OH" => "M-OH",
  "Merrimack" => "MACK",
  "Manhattan" => "MANH",
  "Marquette" => "MARQ",
  "McNeese St." => "MCNS",
  "Memphis" => "MEM",
  "Mercer" => "MER",
  "Mercyhurst" => "MHRT",
  "Miami FL" => "MIA",
  "Michigan" => "MICH",
  "Minnesota" => "MINN",
  "Mississippi" => "MISS",
  "Missouri" => "MIZZ",
  "Maine" => "MNE",
  "UMKC" => "MOKC",
  "Monmouth" => "MONM",
  "Montana" => "MONT",
  "Morehead St." => "MORE",
  "Morgan St." => "MORG",
  "Missouri St." => "MOST",
  "Marshall" => "MRSH",
  "Marist" => "MRST",
  "Mississippi St." => "MSST",
  "Michigan St." => "MSU",
  "Montana St." => "MTST",
  "Mount St. Mary's" => "MTSTM",
  "Middle Tennessee" => "MTSU",
  "Murray St." => "MURR",
  "Mississippi Valley S" => "MVSU",
  "Mississippi Valley St." => "MVSU",
  "North Alabama" => "NA",
  "Northern Arizona" => "NAU",
  "Navy" => "NAVY",
  "North Carolina A&T" => "NCAT",
  "North Carolina Centr" => "NCCU",
  "North Carolina Central" => "NCCU",
  "N.C. State" => "NCST",
  "Notre Dame" => "ND",
  "North Dakota St." => "NDSU",
  "Northeastern" => "NEAS",
  "Nebraska" => "NEB",
  "Nebraska Omaha" => "NEOM",
  "Nevada" => "NEV",
  "Niagara" => "NIAG",
  "Nicholls St." => "NICH",
  "Northern Illinois" => "NIU",
  "NJIT" => "NJIT",
  "Northern Kentucky" => "NKU",
  "New Mexico St." => "NMSU",
  "Norfolk St." => "NORF",
  "Villanova" => "NOVA",
  "Northwestern" => "NW",
  "Northwestern St." => "NWST",
  "Oakland" => "OAKD",
  "Old Dominion" => "ODU",
  "Ohio" => "OHIO",
  "Oklahoma" => "OKLA",
  "Oklahoma St." => "OKST",
  "Oral Roberts" => "ORAL",
  "Oregon" => "ORE",
  "Oregon St." => "ORST",
  "Ohio St." => "OSU",
  "Pacific" => "PAC",
  "Austin Peay" => "PEAY",
  "Penn" => "PENN",
  "Pepperdine" => "PEPP",
  "Purdue Fort Wayne" => "PFW",
  "Pittsburgh" => "PITT",
  "Portland" => "PORT",
  "Presbyterian" => "PRES",
  "Princeton" => "PRIN",
  "Providence" => "PROV",
  "Portland St." => "PRST",
  "Penn St." => "PSU",
  "Purdue" => "PUR",
  "Prairie View A&M" => "PVAM",
  "Queens" => "QNNC",
  "Quinnipiac" => "QPAC",
  "Radford" => "RADF",
  "Rider" => "RDER",
  "Rice" => "RICE",
  "Richmond" => "RICH",
  "Robert Morris" => "RMU",
  "Rutgers" => "RUTG",
  "Sacramento St." => "SAC",
  "Samford" => "SAM",
  "Santa Clara" => "SC",
  "South Carolina" => "SCAR",
  "South Carolina St." => "SCST",
  "South Dakota" => "SDAK",
  "South Dakota St." => "SDKS",
  "San Diego St." => "SDSU",
  "Southeastern Louisiana" => "SELA",
  "Southeastern Louisia" => "SELA",
  "Southeast Missouri S" => "SEMO",
  "Southeast Missouri St." => "SEMO",
  "San Francisco" => "SF",
  "Stephen F. Austin" => "SFA",
  "Saint Francis" => "SFU",
  "Seton Hall" => "SH",
  "Sam Houston St." => "SHSU",
  "Sacred Heart" => "SHU",
  "Siena" => "SIEN",
  "Southern Illinois" => "SIU",
  "SIU Edwardsville" => "SIUE",
  "Saint Joseph's" => "SJPA",
  "San Jose St." => "SJSU",
  "St. John's" => "SJU",
  "SMU" => "SMU",
  "Southern Indiana" => "SOIN",
  "Southern" => "SOU",
  "Stanford" => "STAN",
  "St. Bonaventure" => "STBON",
  "Stetson" => "STET",
  "Saint Louis" => "STLOU",
  "Saint Mary's" => "STMCA",
  "St. Thomas" => "STMN",
  "Stonehill" => "STNH",
  "Stony Brook" => "STON",
  "Saint Peter's" => "STPE",
  "Seattle" => "STTL",
  "Southern Utah" => "SUU",
  "Syracuse" => "SYR",
  "Texas A&M" => "TAMU",
  "Tarleton St." => "TAR",
  "TCU" => "TCU",
  "Temple" => "TEM",
  "Tennessee" => "TENN",
  "Texas" => "TEX",
  "Tulsa" => "TLSA",
  "Tennessee St." => "TNST",
  "Tennessee Tech" => "TNTC",
  "Toledo" => "TOL",
  "Towson" => "TOWS",
  "UT Rio Grande Valley" => "TRGV",
  "Troy" => "TROY",
  "Texas Tech" => "TTU",
  "Tulane" => "TULN",
  "Texas A&M Corpus Chr" => "TXACC",
  "Texas A&M Corpus Chris" => "TXACC",
  "UT Arlington" => "TXARL",
  "Texas Southern" => "TXSO",
  "Texas St." => "TXST",
  "UAB" => "UAB",
  "Little Rock" => "UALR",
  "Central Arkansas" => "UCA",
  "UC Davis" => "UCD",
  "UCF" => "UCF",
  "UC Irvine" => "UCI",
  "UCLA" => "UCLA",
  "UC San Diego" => "UCSD",
  "Georgia" => "UGA",
  "Illinois Chicago" => "UIC",
  "Kentucky" => "UK",
  "Louisiana Monroe" => "ULM",
  "Massachusetts" => "UMASS",
  "UMBC" => "UMBC",
  "Maryland" => "UMD",
  "Maryland Eastern Sho" => "UMES",
  "Maryland Eastern Shore" => "UMES",
  "UMass Lowell" => "UMLW",
  "North Carolina" => "UNC",
  "UNC Asheville" => "UNCA",
  "UNC Greensboro" => "UNCG",
  "Northern Colorado" => "UNCO",
  "UNC Wilmington" => "UNCW",
  "North Dakota" => "UND",
  "North Florida" => "UNFL",
  "New Hampshire" => "UNH",
  "New Haven" => "UNHV",
  "Northern Iowa" => "UNI",
  "UNLV" => "UNLV",
  "New Mexico" => "UNM",
  "New Orleans" => "UNO",
  "North Texas" => "UNT",
  "Rhode Island" => "URI",
  "South Alabama" => "USA",
  "USC" => "USC",
  "USC Upstate" => "USCU",
  "San Diego" => "USD",
  "South Florida" => "USF",
  "Southern Miss" => "USM",
  "Utah St." => "USU",
  "Utah" => "UTAH",
  "UTEP" => "UTEP",
  "Tennessee Martin" => "UTM",
  "UTSA" => "UTSA",
  "Utah Tech" => "UTU",
  "Virginia" => "UVA",
  "Utah Valley" => "UVSU",
  "Green Bay" => "UWGB",
  "Milwaukee" => "UWM",
  "Valparaiso" => "VALP",
  "Vanderbilt" => "VAN",
  "VCU" => "VCU",
  "VMI" => "VMI",
  "Vermont" => "VRMT",
  "Virginia Tech" => "VT",
  "Wagner" => "WAG",
  "Wake Forest" => "WAKE",
  "Washington" => "WASH",
  "Wichita St." => "WCHST",
  "Western Carolina" => "WCU",
  "Weber St." => "WEB",
  "Gardner Webb" => "WEBB",
  "West Georgia" => "WEGA",
  "Winthrop" => "WINT",
  "Wisconsin" => "WIS",
  "Western Illinois" => "WIU",
  "Western Kentucky" => "WKU",
  "William & Mary" => "WMRY",
  "Western Michigan" => "WMU",
  "Wofford" => "WOF",
  "Wright St." => "WRIG",
  "Washington St." => "WSU",
  "West Virginia" => "WVU",
  "Wyoming" => "WYO",
  "Xavier" => "XAV",
  "Yale" => "YALE",
  "Youngstown St." => "YSU"
}

kenpom_overrides = {
  "Alabama A&M" => "AAMU",
  "Abilene Christian" => "ACU",
  "Air Force" => "AFA",
  "Akron" => "AKR",
  "Albany" => "ALBNY",
  "Alcorn St." => "ALCN",
  "Alabama St." => "ALST",
  "American" => "AMER",
  "Appalachian St." => "APP",
  "Arizona" => "ARIZ",
  "Arkansas" => "ARK",
  "Army" => "ARMY",
  "Arkansas Pine Bluff" => "ARPB",
  "Arkansas St." => "ARST",
  "Arizona St." => "ASU",
  "Auburn" => "AUB",
  "Ball St." => "BALL",
  "Alabama" => "BAMA",
  "Baylor" => "BAY",
  "Boston College" => "BC",
  "Bellarmine" => "BELL",
  "Belmont" => "BELM",
  "Bowling Green" => "BGSU",
  "Binghamton" => "BING",
  "Bradley" => "BRAD",
  "Brown" => "BRWN",
  "Bryant" => "BRY",
  "Boise St." => "BSU",
  "Boston University" => "BU",
  "Bucknell" => "BUCK",
  "Buffalo" => "BUFF",
  "Butler" => "BUT",
  "BYU" => "BYU",
  "Cal Baptist" => "CABP",
  "California" => "CAL",
  "Campbell" => "CAMP",
  "Canisius" => "CANI",
  "UC Riverside" => "CARIV",
  "UC Santa Barbara" => "CASB",
  "Cal St. Fullerton" => "CASTF",
  "CSUN" => "CASTN",
  "Coastal Carolina" => "CCAR",
  "Central Connecticut" => "CCTST",
  "Charlotte" => "CHAR",
  "Chattanooga" => "CHAT",
  "Charleston Southern" => "CHSO",
  "Chicago St." => "CHSU",
  "Cincinnati" => "CIN",
  "The Citadel" => "CIT",
  "Clemson" => "CLEM",
  "Cleveland St." => "CLEV",
  "Columbia" => "CLMB",
  "Central Michigan" => "CMU",
  "Charleston" => "COC",
  "Colgate" => "COLG",
  "Colorado" => "COLO",
  "Connecticut" => "CONN",
  "Bethune Cookman" => "COOK",
  "Coppin St." => "COPP",
  "Cornell" => "COR",
  "Cal Poly" => "CP",
  "Creighton" => "CREIG",
  "Colorado St." => "CSU",
  "Cal St. Bakersfield" => "CSUB",
  "Dartmouth" => "DART",
  "Davidson" => "DAV",
  "Dayton" => "DAY",
  "Delaware" => "DEL",
  "Denver" => "DEN",
  "Detroit Mercy" => "DET",
  "DePaul" => "DPAUL",
  "Drexel" => "DREXL",
  "Drake" => "DRKE",
  "Delaware St." => "DSU",
  "Duke" => "DUKE",
  "Duquesne" => "DUQ",
  "East Carolina" => "ECU",
  "Eastern Illinois" => "EIU",
  "Eastern Kentucky" => "EKY",
  "Elon" => "ELON",
  "Eastern Michigan" => "EMU",
  "East Texas A&M" => "ETAM",
  "East Tennessee St." => "ETNST",
  "Evansville" => "EVAN",
  "Eastern Washington" => "EWU",
  "Fairfield" => "FAIR",
  "Florida A&M" => "FAMU",
  "Florida Atlantic" => "FAU",
  "Fairleigh Dickinson" => "FDU",
  "Florida Gulf Coast" => "FGCU",
  "FIU" => "FIU",
  "Florida" => "FLA",
  "Fordham" => "FOR",
  "Fresno St." => "FRES",
  "Florida St." => "FSU",
  "Furman" => "FUR",
  "Georgia Southern" => "GASO",
  "Georgia St." => "GAST",
  "Grand Canyon" => "GCU",
  "George Mason" => "GMU",
  "Gonzaga" => "GONZ",
  "Grambling St." => "GRAM",
  "Georgia Tech" => "GT",
  "Georgetown" => "GTWN",
  "George Washington" => "GW",
  "Hampton" => "HAMP",
  "Harvard" => "HARV",
  "Hawaii" => "HAW",
  "Holy Cross" => "HC",
  "Houston Christian" => "HCU",
  "Hofstra" => "HOF",
  "Houston" => "HOU",
  "Howard" => "HOW",
  "High Point" => "HP",
  "Idaho" => "IDHO",
  "Idaho St." => "IDST",
  "Illinois" => "ILL",
  "Illinois St." => "ILST",
  "Indiana" => "IND",
  "Indiana St." => "INST",
  "Iona" => "IONA",
  "Iowa" => "IOWA",
  "Iowa St." => "ISU",
  "IU Indy" => "IUI",
  "Incarnate Word" => "IW",
  "Jacksonville" => "JAC",
  "Jackson St." => "JKST",
  "James Madison" => "JMU",
  "Jacksonville St." => "JVST",
  "Kent St." => "KENT",
  "Kansas St." => "KSU",
  "Kennesaw St." => "KSW",
  "Kansas" => "KU",
  "Louisiana" => "LA",
  "Lafayette" => "LAF",
  "Lamar" => "LAM",
  "La Salle" => "LASAL",
  "Long Beach St." => "LBS",
  "Lehigh" => "LEH",
  "Liberty" => "LIB",
  "Lindenwood" => "Linden",
  "Lipscomb" => "LIPS",
  "LIU" => "LIU",
  "Le Moyne" => "LMC",
  "Longwood" => "LONG",
  "Louisville" => "LOU",
  "Loyola Chicago" => "LOYIL",
  "Loyola Marymount" => "LOYMR",
  "LSU" => "LSU",
  "Louisiana Tech" => "LT",
  "Loyola MD" => "LUMD",
  "Miami OH" => "M-OH",
  "Merrimack" => "MACK",
  "Manhattan" => "MANH",
  "Marquette" => "MARQ",
  "McNeese" => "MCNS",
  "Memphis" => "MEM",
  "Mercer" => "MER",
  "Mercyhurst" => "MHRT",
  "Miami FL" => "MIA",
  "Michigan" => "MICH",
  "Minnesota" => "MINN",
  "Mississippi" => "MISS",
  "Missouri" => "MIZZ",
  "Maine" => "MNE",
  "Kansas City" => "MOKC",
  "Monmouth" => "MONM",
  "Montana" => "MONT",
  "Morehead St." => "MORE",
  "Morgan St." => "MORG",
  "Missouri St." => "MOST",
  "Marshall" => "MRSH",
  "Marist" => "MRST",
  "Mississippi St." => "MSST",
  "Michigan St." => "MSU",
  "Montana St." => "MTST",
  "Mount St. Mary's" => "MTSTM",
  "Middle Tennessee" => "MTSU",
  "Murray St." => "MURR",
  "Mississippi Valley St." => "MVSU",
  "North Alabama" => "NA",
  "Northern Arizona" => "NAU",
  "Navy" => "NAVY",
  "North Carolina A&T" => "NCAT",
  "North Carolina Central" => "NCCU",
  "N.C. State" => "NCST",
  "Notre Dame" => "ND",
  "North Dakota St." => "NDSU",
  "Northeastern" => "NEAS",
  "Nebraska" => "NEB",
  "Nebraska Omaha" => "NEOM",
  "Nevada" => "NEV",
  "Niagara" => "NIAG",
  "Nicholls" => "NICH",
  "Northern Illinois" => "NIU",
  "NJIT" => "NJIT",
  "Northern Kentucky" => "NKU",
  "New Mexico St." => "NMSU",
  "Norfolk St." => "NORF",
  "Villanova" => "NOVA",
  "Northwestern" => "NW",
  "Northwestern St." => "NWST",
  "Oakland" => "OAKD",
  "Old Dominion" => "ODU",
  "Ohio" => "OHIO",
  "Oklahoma" => "OKLA",
  "Oklahoma St." => "OKST",
  "Oral Roberts" => "ORAL",
  "Oregon" => "ORE",
  "Oregon St." => "ORST",
  "Ohio St." => "OSU",
  "Pacific" => "PAC",
  "Austin Peay" => "PEAY",
  "Penn" => "PENN",
  "Pepperdine" => "PEPP",
  "Purdue Fort Wayne" => "PFW",
  "Pittsburgh" => "PITT",
  "Portland" => "PORT",
  "Presbyterian" => "PRES",
  "Princeton" => "PRIN",
  "Providence" => "PROV",
  "Portland St." => "PRST",
  "Penn St." => "PSU",
  "Purdue" => "PUR",
  "Prairie View A&M" => "PVAM",
  "Queens" => "QNNC",
  "Quinnipiac" => "QPAC",
  "Radford" => "RADF",
  "Rider" => "RDER",
  "Rice" => "RICE",
  "Richmond" => "RICH",
  "Robert Morris" => "RMU",
  "Rutgers" => "RUTG",
  "Sacramento St." => "SAC",
  "Samford" => "SAM",
  "Santa Clara" => "SC",
  "South Carolina" => "SCAR",
  "South Carolina St." => "SCST",
  "South Dakota" => "SDAK",
  "South Dakota St." => "SDKS",
  "San Diego St." => "SDSU",
  "Southeastern Louisiana" => "SELA",
  "Southeast Missouri" => "SEMO",
  "San Francisco" => "SF",
  "Stephen F. Austin" => "SFA",
  "Saint Francis" => "SFU",
  "Seton Hall" => "SH",
  "Sam Houston St." => "SHSU",
  "Sacred Heart" => "SHU",
  "Siena" => "SIEN",
  "Southern Illinois" => "SIU",
  "SIUE" => "SIUE",
  "Saint Joseph's" => "SJPA",
  "San Jose St." => "SJSU",
  "St. John's" => "SJU",
  "SMU" => "SMU",
  "Southern Indiana" => "SOIN",
  "Southern" => "SOU",
  "Stanford" => "STAN",
  "St. Bonaventure" => "STBON",
  "Stetson" => "STET",
  "Saint Louis" => "STLOU",
  "Saint Mary's" => "STMCA",
  "St. Thomas" => "STMN",
  "Stonehill" => "STNH",
  "Stony Brook" => "STON",
  "Saint Peter's" => "STPE",
  "Seattle" => "STTL",
  "Southern Utah" => "SUU",
  "Syracuse" => "SYR",
  "Texas A&M" => "TAMU",
  "Tarleton St." => "TAR",
  "TCU" => "TCU",
  "Temple" => "TEM",
  "Tennessee" => "TENN",
  "Texas" => "TEX",
  "Tulsa" => "TLSA",
  "Tennessee St." => "TNST",
  "Tennessee Tech" => "TNTC",
  "Toledo" => "TOL",
  "Towson" => "TOWS",
  "UT Rio Grande Valley" => "TRGV",
  "Troy" => "TROY",
  "Texas Tech" => "TTU",
  "Tulane" => "TULN",
  "Texas A&M Corpus Chris" => "TXACC",
  "UT Arlington" => "TXARL",
  "Texas Southern" => "TXSO",
  "Texas St." => "TXST",
  "UAB" => "UAB",
  "Little Rock" => "UALR",
  "Central Arkansas" => "UCA",
  "UC Davis" => "UCD",
  "UCF" => "UCF",
  "UC Irvine" => "UCI",
  "UCLA" => "UCLA",
  "UC San Diego" => "UCSD",
  "Georgia" => "UGA",
  "Illinois Chicago" => "UIC",
  "Kentucky" => "UK",
  "Louisiana Monroe" => "ULM",
  "Massachusetts" => "UMASS",
  "UMBC" => "UMBC",
  "Maryland" => "UMD",
  "Maryland Eastern Shore" => "UMES",
  "UMass Lowell" => "UMLW",
  "North Carolina" => "UNC",
  "UNC Asheville" => "UNCA",
  "UNC Greensboro" => "UNCG",
  "Northern Colorado" => "UNCO",
  "UNC Wilmington" => "UNCW",
  "North Dakota" => "UND",
  "North Florida" => "UNFL",
  "New Hampshire" => "UNH",
  "New Haven" => "UNHV",
  "Northern Iowa" => "UNI",
  "UNLV" => "UNLV",
  "New Mexico" => "UNM",
  "New Orleans" => "UNO",
  "North Texas" => "UNT",
  "Rhode Island" => "URI",
  "South Alabama" => "USA",
  "USC" => "USC",
  "USC Upstate" => "USCU",
  "San Diego" => "USD",
  "South Florida" => "USF",
  "Southern Miss" => "USM",
  "Utah St." => "USU",
  "Utah" => "UTAH",
  "UTEP" => "UTEP",
  "Tennessee Martin" => "UTM",
  "UTSA" => "UTSA",
  "Utah Tech" => "UTU",
  "Virginia" => "UVA",
  "Utah Valley" => "UVSU",
  "Green Bay" => "UWGB",
  "Milwaukee" => "UWM",
  "Valparaiso" => "VALP",
  "Vanderbilt" => "VAN",
  "VCU" => "VCU",
  "VMI" => "VMI",
  "Vermont" => "VRMT",
  "Virginia Tech" => "VT",
  "Wagner" => "WAG",
  "Wake Forest" => "WAKE",
  "Washington" => "WASH",
  "Wichita St." => "WCHST",
  "Western Carolina" => "WCU",
  "Weber St." => "WEB",
  "Gardner Webb" => "WEBB",
  "West Georgia" => "WEGA",
  "Winthrop" => "WINT",
  "Wisconsin" => "WIS",
  "Western Illinois" => "WIU",
  "Western Kentucky" => "WKU",
  "William & Mary" => "WMRY",
  "Western Michigan" => "WMU",
  "Wofford" => "WOF",
  "Wright St." => "WRIG",
  "Washington St." => "WSU",
  "West Virginia" => "WVU",
  "Wyoming" => "WYO",
  "Xavier" => "XAV",
  "Yale" => "YALE",
  "Youngstown St." => "YSU"
}

overrides_by_league_and_source = {
  "mlb" => {
    "espn" => {
      "KC" => "KCR",
      "SD" => "SDP",
      "SF" => "SFG",
      "TB" => "TBR",
      "WSH" => "WSN",
    },
    "sportsline" => {
      "KC" => "KCR",
      "SD" => "SDP",
      "SF" => "SFG",
      "TB" => "TBR",
      "WAS" => "WSN"
    },
    "mlb_api" => {
      "AZ" => "ARI",
      "CWS" => "CHW",
      "KC" => "KCR",
      "SD" => "SDP",
      "SF" => "SFG",
      "TB" => "TBR",
      "WSH" => "WSN"
    },
    "roto_wire" => {
      "CWS" => "CHW",
      "KC" => "KCR",
      "SD" => "SDP",
      "SF" => "SFG",
      "TB" => "TBR",
      "WSH" => "WSN"
    }
    # fan_graphs has no overrides â€” all team codes match
  },
  "nfl" => {
    "espn" => {
      "GB" => "GNB",
      "KC" => "KAN",
      "LV" => "LVR",
      "NO" => "NOR",
      "NE" => "NWE",
      "SF" => "SFO",
      "TB" => "TAM",
      "WAS" => "WSH"
    },
    "sportsline" => {
      "GB" => "GNB",
      "JAC" => "JAX",
      "KC" => "KAN",
      "NO" => "NOR",
      "NE" => "NWE",
      "SF" => "SFO",
      "TB" => "TAM",
    }
  },
  "ncaaf" => {
    "sportsline" => shared_sportsline_overrides,
    "espn" => shared_espn_overrides
  },
  "ncaam" => {
    "sportsline" => shared_sportsline_overrides,
    "espn" => shared_espn_overrides,
    "barttorvik" => barttorvik_overrides,
    "ken_pom" => kenpom_overrides
  }
}

# Step 4: Seed team identifiers
overrides_by_league_and_source.each do |league_code, source_overrides|
  league = leagues.fetch(league_code)

  source_overrides.each do |source_code, team_overrides|
    source = sources.fetch(source_code)

    # Get teams for this league via the join table
    league_teams = league.teams
    teams_by_code = league_teams.index_by(&:code)

    # Now hash is external_code => internal_code
    team_overrides.each do |external_code, internal_code|
      team = teams_by_code[internal_code]
      next unless team

      ti = TeamIdentifier.find_or_initialize_by(
        league: league,
        data_source: source,
        external_code: external_code
      )
      ti.team = team
      ti.active = true
      ti.save!
    end

    # Also create identifiers for teams without overrides (external = internal)
    league_teams.each do |team|
      next if team_overrides.values.include?(team.code)  # Already handled above

      ti = TeamIdentifier.find_or_initialize_by(
        league: league,
        data_source: source,
        external_code: team.code
      )
      ti.team = team
      ti.active = true
      ti.save!
    end
  end
end