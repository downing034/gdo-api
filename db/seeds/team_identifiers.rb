leagues = League.where(code: %w[mlb nfl ncaaf ncaam]).index_by(&:code)
sources = DataSource.where(code: %w[sportsline mlb_api roto_wire espn barttorvik ken_pom]).index_by(&:code)

shared_sportsline_overrides = {
  "AAMU" => "ALAM",
  "ACU" => "ABIL",
  "AFA" => "AF",
  "AKR" => "AKRON",
  "ALBNY" => "ALBANY",
  "APP" => "APLST",
  "ARST" => "ARKST",
  "ASU" => "ARIZST",
  "AUB" => "AUBURN",
  "BALL" => "BALLST",
  "BAY" => "BAYLOR",
  "BELL" => "BELLAR",
  "BELM" => "BELMONT",
  "BGSU" => "BGREEN",
  "BRWN" => "BROWN",
  "BRY" => "BRYANT",
  "BSU" => "BOISE",
  "BUT" => "BUTLER",
  "CABP" => "CALBPTST",
  "CANI" => "CAN",
  "CARIV" => "UCRIV",
  "CASB" => "UCSB",
  "CASTN" => "CSN",
  "CASTF" => "CSFULL",
  "CCAR" => "CSTCAR",
  "CHAR" => "CHARLO",
  "CHAT" => "TNCHAT",
  "CHSO" => "CHARSO",
  "CHSU" => "CHIST",
  "CIN" => "CINCY",
  "CLEV" => "CLEVST",
  "CMU" => "CMICH",
  "COC" => "CHARLS",
  "CONN" => "UCONN",
  "COOK" => "BTHU",
  "COPP" => "COPPST",
  "COR" => "CORN",
  "CP" => "CPOLY",
  "CREIG" => "CREIGH",
  "CSU" => "COLOST",
  "CSUB" => "CSBAK",
  "DAV" => "DAVID",
  "DAY" => "DAYTON",
  "DEL" => "DE",
  "DEN" => "DENVER",
  "DET" => "DTROIT",
  "DPAUL" => "DEPAUL",
  "DREXL" => "DREXEL",
  "DRKE" => "DRAKE",
  "DSU" => "DELST",
  "EIU" => "EILL",
  "EMU" => "EMICH",
  "ETAM" => "TAMC",
  "EWU" => "EWASH",
  "FOR" => "FORD",
  "FUR" => "FURMAN",
  "FRES" => "FRESNO",
  "GASO" => "GAS",
  "GCU" => "GC",
  "GMU" => "GMASON",
  "GONZ" => "GONZAG",
  "GT" => "GATECH",
  "GTWN" => "GTOWN",
  "GW" => "GWASH",
  "HAW" => "HAWAII",
  "HC" => "HOLY",
  "HOF" => "HOFSTRA",
  "HP" => "HIGHPT",
  "IDHO" => "IDAHO",
  "INST" => "INDST",
  "ISU" => "IOWAST",
  "JAC" => "JVILLE",
  "JKST" => "JACKST",
  "JMU" => "JMAD",
  "JVST" => "JAXST",
  "KENT" => "KENTST",
  "KSU" => "KSTATE",
  "KSW" => "KENSAW",
  "KU" => "KANSAS",
  "LAM" => "LAMAR",
  "LASAL" => "LSALLE",
  "LBS" => "LNGBCH",
  "LEH" => "LEHIGH",
  "LIPS" => "LPSCMB",
  "LMC" => "LEMOYN",
  "LONG" => "LONGWD",
  "LOU" => "LVILLE",
  "LOYIL" => "LOYCHI",
  "LOYMR" => "LOYMRY",
  "LT" => "LATECH",
  "LUMD" => "LOYMD",
  "Linden" => "LINDEN",
  "M-OH" => "MIAOH",
  "MACK" => "MERMAK",
  "MARQ" => "MARQET",
  "MCNS" => "MCNSE",
  "MER" => "MERCER",
  "MHRT" => "MERCYH",
  "MIA" => "MIAMI",
  "MIZZ" => "MIZZOU",
  "MNE" => "MAINE",
  "MOKC" => "UMKC",
  "MONT" => "MNTNA",
  "MORE" => "MOREHD",
  "MORG" => "MORGAN",
  "MRST" => "MARIST",
  "MSST" => "MISSST",
  "MSU" => "MICHST",
  "MTST" => "MONST",
  "MTSTM" => "MOUNT",
  "NA" => "NAL",
  "NCCU" => "NCCEN",
  "NDSU" => "NDAKST",
  "NEAS" => "NEAST",
  "NEOM" => "NEBOM",
  "NEV" => "NEVADA",
  "NICH" => "NICHST",
  "NIU" => "NILL",
  "NJIT" => "NJTECH",
  "NKU" => "NKY",
  "NMSU" => "NMEXST",
  "NW" => "NWEST",
  "OAKD" => "OAK",
  "OKST" => "OKLAST",
  "ORE" => "OREG",
  "ORST" => "OREGST",
  "OSU" => "OHIOST",
  "PAC" => "UOP",
  "PEAY" => "AP",
  "PEPP" => "PEPPER",
  "PFW" => "IPFW",
  "PRES" => "PRESBY",
  "PRIN" => "PRINCE",
  "PRST" => "PORTST",
  "PUR" => "PURDUE",
  "QNNC" => "QUEENC",
  "QPAC" => "QUINN",
  "RADF" => "RADFRD",
  "RDER" => "RIDER",
  "RMU" => "ROB",
  "RUTG" => "RUT",
  "SAC" => "SACST",
  "SC" => "SNCLRA",
  "SCAR" => "SC",
  "SDKS" => "SDAKST",
  "SDSU" => "SDGST",
  "SELA" => "SELOU",
  "SEMO" => "SEMOST",
  "SF" => "SANFRAN",
  "SFU" => "STRFPA",
  "SH" => "SETON",
  "SHSU" => "SAMST",
  "SHU" => "SACHRT",
  "SIEN" => "SIENA",
  "SIU" => "SIL",
  "SJPA" => "STJOES",
  "SJSU" => "SJST",
  "SJU" => "STJOHN",
  "SOIN" => "SOINDI",
  "STAN" => "STNFRD",
  "STET" => "STETSON",
  "STMCA" => "MARYCA",
  "STMN" => "STTHMN",
  "STNH" => "STONH",
  "STON" => "STONYBRK",
  "STPE" => "STPETE",
  "STTL" => "SEATTLE",
  "SUU" => "SUTAH",
  "SYR" => "CUSE",
  "TAMU" => "TXAM",
  "TAR" => "TRLST",
  "TEM" => "TEMPLE",
  "TEX" => "TEXAS",
  "TLSA" => "TULSA",
  "TNTC" => "TNTECH",
  "TOL" => "TOLEDO",
  "TRGV" => "TEXPA",
  "TTU" => "TXTECH",
  "TULN" => "TULANE",
  "TXACC" => "TXAMCC",
  "TXSO" => "TEXSO",
  "TXST" => "TXSTSM",
  "UALR" => "ARKLR",
  "UCA" => "CAR",
  "UCD" => "DAVIS",
  "UCI" => "UCIRV",
  "UCSD" => "CALSD",
  "UIC" => "ILLCHI",
  "ULM" => "LAMON",
  "UMD" => "MD",
  "UMLW" => "MASLOW",
  "UNCA" => "NCASHV",
  "UNCG" => "NCGRN",
  "UNCW" => "NCWILM",
  "UNCO" => "NCOLO",
  "UND" => "NDAK",
  "UNFL" => "UNF",
  "UNH" => "NHAV",
  "UNI" => "NIOWA",
  "UNM" => "NMEX",
  "UNO" => "NORL",
  "UNT" => "NTEXAS",
  "URI" => "RI",
  "USA" => "SALA",
  "USCU" => "USCUP",
  "USF" => "SFLA",
  "USU" => "UTAHST",
  "UTM" => "TNMART",
  "UTSA" => "TXSA",
  "UVSU" => "UTVALL",
  "UWGB" => "WISGB",
  "UWM" => "MILW",
  "VALP" => "VALPO",
  "VAN" => "VANDY",
  "VRMT" => "UVM",
  "VT" => "VATECH",
  "WAG" => "WAGNER",
  "WCHST" => "WICHST",
  "WCU" => "WCAR",
  "WEB" => "WBRST",
  "WEBB" => "GWEBB",
  "WEGA" => "WESTGA",
  "WINT" => "WINTHR",
  "WIS" => "WISC",
  "WIU" => "WIL",
  "WKU" => "WKY",
  "WMRY" => "WMMARY",
  "WMU" => "WMICH",
  "WOF" => "WOFF",
  "WRIG" => "WRIGHT",
  "WSU" => "WASHST",
  "XAV" => "XAVIER"
}

shared_espn_overrides = {
  "AFA" => "AF",
  "ALBNY" => "UALB",
  "ARPB" => "UAPB",
  "BAMA" => "ALA",
  "BELM" => "BEL",
  "BSU" => "BOIS",
  "BUFF" => "BUF",
  "CABP" => "CBU",
  "CAMP" => "CAM",
  "CANI" => "CAN",
  "CARIV" => "UCR",
  "CASB" => "UCSB",
  "CASTF" => "CSUF",
  "CASTN" => "CSUN",
  "CCAR" => "CCU",
  "CCTST" => "CCSU",
  "CHAR" => "CLT",
  "CHAT" => "UTC",
  "CHSU" => "CHST",
  "CLEV" => "CLE",
  "CLMB" => "COLU",
  "COC" => "COFC",
  "COOK" => "BCU",
  "CREIG" => "CREI",
  "DET" => "DETM",
  "DPAUL" => "DEP",
  "DREXL" => "DREX",
  "EKY" => "EKU",
  "ETNST" => "ETSU",
  "HP" => "HPU",
  "IND" => "IU",
  "IUI" => "IUIN",
  "IW" => "UIW",
  "JAC" => "JAX",
  "JVST" => "JXST",
  "KSW" => "KENN",
  "LA" => "UL",
  "LASAL" => "LAS",
  "LBS" => "LBSU",
  "Linden" => "LIN",
  "LIPS" => "LIP",
  "LMC" => "LEM",
  "LOYIL" => "LUC",
  "LOYMR" => "LMU",
  "LUMD" => "L-MD",
  "MACK" => "MRMK",
  "MANH" => "MAN",
  "MCNS" => "MCN",
  "MHRT" => "MERC",
  "MNE" => "ME",
  "MIZZ" => "MIZ",
  "MOKC" => "KC",
  "MTSTM" => "MSM",
  "MURR" => "MUR",
  "NA" => "UNA",
  "NCST" => "NCSU",
  "NEAS" => "NE",
  "NEOM" => "OMA",
  "NIAG" => "NIA",
  "NOVA" => "VILL",
  "NW" => "NU",
  "OAKD" => "OAK",
  "OKLA" => "OU",
  "ORAL" => "ORU",
  "PEAY" => "APSU",
  "PVAM" => "PV",
  "QNNC" => "QUC",
  "QPAC" => "QUIN",
  "RADF" => "RAD",
  "RDER" => "RID",
  "SC" => "SCU",
  "SCAR" => "SC",
  "SDKS" => "SDST",
  "SFU" => "SFPA",
  "SH" => "HALL",
  "SIEN" => "SIE",
  "SJPA" => "JOES",
  "SOIN" => "USI",
  "STBON" => "SBU",
  "STLOU" => "SLU",
  "STMCA" => "SMC",
  "STNH" => "STO",
  "STON" => "STBK",
  "STPE" => "SPU",
  "STTL" => "SEA",
  "TAMU" => "TA&M",
  "TOWS" => "TOW",
  "TRGV" => "RGV",
  "TXACC" => "AMCC",
  "TXARL" => "UTA",
  "UALR" => "LR",
  "UCA" => "CARK",
  "UMASS" => "MASS",
  "UMD" => "MD",
  "UMLW" => "UML",
  "UNFL" => "UNF",
  "UNHV" => "NHVN",
  "USCU" => "UPST",
  "UVSU" => "UVU",
  "UWGB" => "GB",
  "UWM" => "MILW",
  "VALP" => "VAL",
  "VRMT" => "UVM",
  "WEBB" => "GWEB",
  "WEGA" => "WGA",
  "WCHST" => "WICH",
  "WINT" => "WIN",
  "WMRY" => "W&M",
  "WRIG" => "WRST",
}

barttorvik_overrides = {
  "AAMU" => "Alabama A&M",
  "ACU" => "Abilene Christian",
  "AFA" => "Air Force",
  "AKR" => "Akron",
  "ALBNY" => "Albany",
  "ALCN" => "Alcorn St.",
  "ALST" => "Alabama St.",
  "AMER" => "American",
  "APP" => "Appalachian St.",
  "ARIZ" => "Arizona",
  "ARK" => "Arkansas",
  "ARMY" => "Army",
  "ARPB" => "Arkansas Pine Bluff",
  "ARST" => "Arkansas St.",
  "ASU" => "Arizona St.",
  "AUB" => "Auburn",
  "BALL" => "Ball St.",
  "BAMA" => "Alabama",
  "BAY" => "Baylor",
  "BC" => "Boston College",
  "BELL" => "Bellarmine",
  "BELM" => "Belmont",
  "BGSU" => "Bowling Green",
  "BING" => "Binghamton",
  "BRAD" => "Bradley",
  "BRWN" => "Brown",
  "BRY" => "Bryant",
  "BSU" => "Boise St.",
  "BU" => "Boston University",
  "BUCK" => "Bucknell",
  "BUFF" => "Buffalo",
  "BUT" => "Butler",
  "BYU" => "BYU",
  "CABP" => "Cal Baptist",
  "CAL" => "California",
  "CAMP" => "Campbell",
  "CANI" => "Canisius",
  "CARIV" => "UC Riverside",
  "CASB" => "UC Santa Barbara",
  "CASTF" => "Cal St. Fullerton",
  "CASTN" => "Cal St. Northridge",
  "CCAR" => "Coastal Carolina",
  "CCTST" => "Central Connecticut",
  "CHAR" => "Charlotte",
  "CHAT" => "Chattanooga",
  "CHSO" => "Charleston Southern",
  "CHSU" => "Chicago St.",
  "CIN" => "Cincinnati",
  "CIT" => "The Citadel",
  "CLEM" => "Clemson",
  "CLEV" => "Cleveland St.",
  "CLMB" => "Columbia",
  "CMU" => "Central Michigan",
  "COC" => "Charleston",
  "COLG" => "Colgate",
  "COLO" => "Colorado",
  "CONN" => "Connecticut",
  "COOK" => "Bethune Cookman",
  "COPP" => "Coppin St.",
  "COR" => "Cornell",
  "CP" => "Cal Poly",
  "CREIG" => "Creighton",
  "CSU" => "Colorado St.",
  "CSUB" => "Cal St. Bakersfield",
  "DART" => "Dartmouth",
  "DAV" => "Davidson",
  "DAY" => "Dayton",
  "DEL" => "Delaware",
  "DEN" => "Denver",
  "DET" => "Detroit Mercy",
  "DPAUL" => "DePaul",
  "DREXL" => "Drexel",
  "DRKE" => "Drake",
  "DSU" => "Delaware St.",
  "DUKE" => "Duke",
  "DUQ" => "Duquesne",
  "ECU" => "East Carolina",
  "EIU" => "Eastern Illinois",
  "EKY" => "Eastern Kentucky",
  "ELON" => "Elon",
  "EMU" => "Eastern Michigan",
  "ETAM" => "East Texas A&M",
  "ETNST" => "East Tennessee St.",
  "EVAN" => "Evansville",
  "EWU" => "Eastern Washington",
  "FAIR" => "Fairfield",
  "FAMU" => "Florida A&M",
  "FAU" => "Florida Atlantic",
  "FDU" => "Fairleigh Dickinson",
  "FGCU" => "Florida Gulf Coast",
  "FIU" => "FIU",
  "FLA" => "Florida",
  "FOR" => "Fordham",
  "FRES" => "Fresno St.",
  "FSU" => "Florida St.",
  "FUR" => "Furman",
  "GASO" => "Georgia Southern",
  "GAST" => "Georgia St.",
  "GCU" => "Grand Canyon",
  "GMU" => "George Mason",
  "GONZ" => "Gonzaga",
  "GRAM" => "Grambling St.",
  "GT" => "Georgia Tech",
  "GTWN" => "Georgetown",
  "GW" => "George Washington",
  "HAMP" => "Hampton",
  "HARV" => "Harvard",
  "HAW" => "Hawaii",
  "HC" => "Holy Cross",
  "HCU" => "Houston Christian",
  "HOF" => "Hofstra",
  "HOU" => "Houston",
  "HOW" => "Howard",
  "HP" => "High Point",
  "IDHO" => "Idaho",
  "IDST" => "Idaho St.",
  "ILL" => "Illinois",
  "ILST" => "Illinois St.",
  "IND" => "Indiana",
  "INST" => "Indiana St.",
  "IONA" => "Iona",
  "IOWA" => "Iowa",
  "ISU" => "Iowa St.",
  "IUI" => "IU Indy",
  "IW" => "Incarnate Word",
  "JAC" => "Jacksonville",
  "JKST" => "Jackson St.",
  "JMU" => "James Madison",
  "JVST" => "Jacksonville St.",
  "KENT" => "Kent St.",
  "KSU" => "Kansas St.",
  "KSW" => "Kennesaw St.",
  "KU" => "Kansas",
  "LA" => "Louisiana",
  "LAF" => "Lafayette",
  "LAM" => "Lamar",
  "LASAL" => "La Salle",
  "LBS" => "Long Beach St.",
  "LEH" => "Lehigh",
  "LIB" => "Liberty",
  "Linden" => "Lindenwood",
  "LIPS" => "Lipscomb",
  "LIU" => "LIU",
  "LMC" => "Le Moyne",
  "LONG" => "Longwood",
  "LOU" => "Louisville",
  "LOYIL" => "Loyola Chicago",
  "LOYMR" => "Loyola Marymount",
  "LSU" => "LSU",
  "LT" => "Louisiana Tech",
  "LUMD" => "Loyola MD",
  "M-OH" => "Miami OH",
  "MACK" => "Merrimack",
  "MANH" => "Manhattan",
  "MARQ" => "Marquette",
  "MCNS" => "McNeese St.",
  "MEM" => "Memphis",
  "MER" => "Mercer",
  "MHRT" => "Mercyhurst",
  "MIA" => "Miami FL",
  "MICH" => "Michigan",
  "MINN" => "Minnesota",
  "MISS" => "Mississippi",
  "MIZZ" => "Missouri",
  "MNE" => "Maine",
  "MOKC" => "UMKC",
  "MONM" => "Monmouth",
  "MONT" => "Montana",
  "MORE" => "Morehead St.",
  "MORG" => "Morgan St.",
  "MOST" => "Missouri St.",
  "MRSH" => "Marshall",
  "MRST" => "Marist",
  "MSST" => "Mississippi St.",
  "MSU" => "Michigan St.",
  "MTST" => "Montana St.",
  "MTSTM" => "Mount St. Mary's",
  "MTSU" => "Middle Tennessee",
  "MURR" => "Murray St.",
  "MVSU" => "Mississippi Valley S",
  # "MVSU" => "Mississippi Valley St.",
  "NA" => "North Alabama",
  "NAU" => "Northern Arizona",
  "NAVY" => "Navy",
  "NCAT" => "North Carolina A&T",
  "NCCU" => "North Carolina Centr",
  # "NCCU" => "North Carolina Central",
  "NCST" => "N.C. State",
  "ND" => "Notre Dame",
  "NDSU" => "North Dakota St.",
  "NEAS" => "Northeastern",
  "NEB" => "Nebraska",
  "NEOM" => "Nebraska Omaha",
  "NEV" => "Nevada",
  "NIAG" => "Niagara",
  "NICH" => "Nicholls St.",
  "NIU" => "Northern Illinois",
  "NJIT" => "NJIT",
  "NKU" => "Northern Kentucky",
  "NMSU" => "New Mexico St.",
  "NORF" => "Norfolk St.",
  "NOVA" => "Villanova",
  "NW" => "Northwestern",
  "NWST" => "Northwestern St.",
  "OAKD" => "Oakland",
  "ODU" => "Old Dominion",
  "OHIO" => "Ohio",
  "OKLA" => "Oklahoma",
  "OKST" => "Oklahoma St.",
  "ORAL" => "Oral Roberts",
  "ORE" => "Oregon",
  "ORST" => "Oregon St.",
  "OSU" => "Ohio St.",
  "PAC" => "Pacific",
  "PEAY" => "Austin Peay",
  "PENN" => "Penn",
  "PEPP" => "Pepperdine",
  "PFW" => "Purdue Fort Wayne",
  "PITT" => "Pittsburgh",
  "PORT" => "Portland",
  "PRES" => "Presbyterian",
  "PRIN" => "Princeton",
  "PROV" => "Providence",
  "PRST" => "Portland St.",
  "PSU" => "Penn St.",
  "PUR" => "Purdue",
  "PVAM" => "Prairie View A&M",
  "QNNC" => "Queens",
  "QPAC" => "Quinnipiac",
  "RADF" => "Radford",
  "RDER" => "Rider",
  "RICE" => "Rice",
  "RICH" => "Richmond",
  "RMU" => "Robert Morris",
  "RUTG" => "Rutgers",
  "SAC" => "Sacramento St.",
  "SAM" => "Samford",
  "SC" => "Santa Clara",
  "SCAR" => "South Carolina",
  "SCST" => "South Carolina St.",
  "SDAK" => "South Dakota",
  "SDKS" => "South Dakota St.",
  "SDSU" => "San Diego St.",
  # "SELA" => "Southeastern Louisiana",
  "SELA" => "Southeastern Louisia",
  "SEMO" => "Southeast Missouri S",
  # "SEMO" => "Southeast Missouri St.",
  "SF" => "San Francisco",
  "SFA" => "Stephen F. Austin",
  "SFU" => "Saint Francis",
  "SH" => "Seton Hall",
  "SHSU" => "Sam Houston St.",
  "SHU" => "Sacred Heart",
  "SIEN" => "Siena",
  "SIU" => "Southern Illinois",
  "SIUE" => "SIU Edwardsville",
  "SJPA" => "Saint Joseph's",
  "SJSU" => "San Jose St.",
  "SJU" => "St. John's",
  "SMU" => "SMU",
  "SOIN" => "Southern Indiana",
  "SOU" => "Southern",
  "STAN" => "Stanford",
  "STBON" => "St. Bonaventure",
  "STET" => "Stetson",
  "STLOU" => "Saint Louis",
  "STMCA" => "Saint Mary's",
  "STMN" => "St. Thomas",
  "STNH" => "Stonehill",
  "STON" => "Stony Brook",
  "STPE" => "Saint Peter's",
  "STTL" => "Seattle",
  "SUU" => "Southern Utah",
  "SYR" => "Syracuse",
  "TAMU" => "Texas A&M",
  "TAR" => "Tarleton St.",
  "TCU" => "TCU",
  "TEM" => "Temple",
  "TENN" => "Tennessee",
  "TEX" => "Texas",
  "TLSA" => "Tulsa",
  "TNST" => "Tennessee St.",
  "TNTC" => "Tennessee Tech",
  "TOL" => "Toledo",
  "TOWS" => "Towson",
  "TRGV" => "UT Rio Grande Valley",
  "TROY" => "Troy",
  "TTU" => "Texas Tech",
  "TULN" => "Tulane",
  "TXACC" => "Texas A&M Corpus Chr",
  # "TXACC" => "Texas A&M Corpus Chris",
  "TXARL" => "UT Arlington",
  "TXSO" => "Texas Southern",
  "TXST" => "Texas St.",
  "UAB" => "UAB",
  "UALR" => "Little Rock",
  "UCA" => "Central Arkansas",
  "UCD" => "UC Davis",
  "UCF" => "UCF",
  "UCI" => "UC Irvine",
  "UCLA" => "UCLA",
  "UCSD" => "UC San Diego",
  "UGA" => "Georgia",
  "UIC" => "Illinois Chicago",
  "UK" => "Kentucky",
  "ULM" => "Louisiana Monroe",
  "UMASS" => "Massachusetts",
  "UMBC" => "UMBC",
  "UMD" => "Maryland",
  "UMES" => "Maryland Eastern Sho",
  # "UMES" => "Maryland Eastern Shore",
  "UMLW" => "UMass Lowell",
  "UNC" => "North Carolina",
  "UNCA" => "UNC Asheville",
  "UNCG" => "UNC Greensboro",
  "UNCO" => "Northern Colorado",
  "UNCW" => "UNC Wilmington",
  "UND" => "North Dakota",
  "UNFL" => "North Florida",
  "UNH" => "New Hampshire",
  "UNHV" => "New Haven",
  "UNI" => "Northern Iowa",
  "UNLV" => "UNLV",
  "UNM" => "New Mexico",
  "UNO" => "New Orleans",
  "UNT" => "North Texas",
  "URI" => "Rhode Island",
  "USA" => "South Alabama",
  "USC" => "USC",
  "USCU" => "USC Upstate",
  "USD" => "San Diego",
  "USF" => "South Florida",
  "USM" => "Southern Miss",
  "USU" => "Utah St.",
  "UTAH" => "Utah",
  "UTEP" => "UTEP",
  "UTM" => "Tennessee Martin",
  "UTSA" => "UTSA",
  "UTU" => "Utah Tech",
  "UVA" => "Virginia",
  "UVSU" => "Utah Valley",
  "UWGB" => "Green Bay",
  "UWM" => "Milwaukee",
  "VALP" => "Valparaiso",
  "VAN" => "Vanderbilt",
  "VCU" => "VCU",
  "VMI" => "VMI",
  "VRMT" => "Vermont",
  "VT" => "Virginia Tech",
  "WAG" => "Wagner",
  "WAKE" => "Wake Forest",
  "WASH" => "Washington",
  "WCHST" => "Wichita St.",
  "WCU" => "Western Carolina",
  "WEB" => "Weber St.",
  "WEBB" => "Gardner Webb",
  "WEGA" => "West Georgia",
  "WINT" => "Winthrop",
  "WIS" => "Wisconsin",
  "WIU" => "Western Illinois",
  "WKU" => "Western Kentucky",
  "WMRY" => "William & Mary",
  "WMU" => "Western Michigan",
  "WOF" => "Wofford",
  "WRIG" => "Wright St.",
  "WSU" => "Washington St.",
  "WVU" => "West Virginia",
  "WYO" => "Wyoming",
  "XAV" => "Xavier",
  "YALE" => "Yale",
  "YSU" => "Youngstown St."
}

kenpom_overrides = {
  "AAMU" => "Alabama A&M",
  "ACU" => "Abilene Christian",
  "AFA" => "Air Force",
  "AKR" => "Akron",
  "ALBNY" => "Albany",
  "ALCN" => "Alcorn St.",
  "ALST" => "Alabama St.",
  "AMER" => "American",
  "APP" => "Appalachian St.",
  "ARIZ" => "Arizona",
  "ARK" => "Arkansas",
  "ARMY" => "Army",
  "ARPB" => "Arkansas Pine Bluff",
  "ARST" => "Arkansas St.",
  "ASU" => "Arizona St.",
  "AUB" => "Auburn",
  "BALL" => "Ball St.",
  "BAMA" => "Alabama",
  "BAY" => "Baylor",
  "BC" => "Boston College",
  "BELL" => "Bellarmine",
  "BELM" => "Belmont",
  "BGSU" => "Bowling Green",
  "BING" => "Binghamton",
  "BRAD" => "Bradley",
  "BRWN" => "Brown",
  "BRY" => "Bryant",
  "BSU" => "Boise St.",
  "BU" => "Boston University",
  "BUCK" => "Bucknell",
  "BUFF" => "Buffalo",
  "BUT" => "Butler",
  "BYU" => "BYU",
  "CABP" => "Cal Baptist",
  "CAL" => "California",
  "CAMP" => "Campbell",
  "CANI" => "Canisius",
  "CARIV" => "UC Riverside",
  "CASB" => "UC Santa Barbara",
  "CASTF" => "Cal St. Fullerton",
  "CASTN" => "CSUN",
  "CCAR" => "Coastal Carolina",
  "CCTST" => "Central Connecticut",
  "CHAR" => "Charlotte",
  "CHAT" => "Chattanooga",
  "CHSO" => "Charleston Southern",
  "CHSU" => "Chicago St.",
  "CIN" => "Cincinnati",
  "CIT" => "The Citadel",
  "CLEM" => "Clemson",
  "CLEV" => "Cleveland St.",
  "CLMB" => "Columbia",
  "CMU" => "Central Michigan",
  "COC" => "Charleston",
  "COLG" => "Colgate",
  "COLO" => "Colorado",
  "CONN" => "Connecticut",
  "COOK" => "Bethune Cookman",
  "COPP" => "Coppin St.",
  "COR" => "Cornell",
  "CP" => "Cal Poly",
  "CREIG" => "Creighton",
  "CSU" => "Colorado St.",
  "CSUB" => "Cal St. Bakersfield",
  "DART" => "Dartmouth",
  "DAV" => "Davidson",
  "DAY" => "Dayton",
  "DEL" => "Delaware",
  "DEN" => "Denver",
  "DET" => "Detroit Mercy",
  "DPAUL" => "DePaul",
  "DREXL" => "Drexel",
  "DRKE" => "Drake",
  "DSU" => "Delaware St.",
  "DUKE" => "Duke",
  "DUQ" => "Duquesne",
  "ECU" => "East Carolina",
  "EIU" => "Eastern Illinois",
  "EKY" => "Eastern Kentucky",
  "ELON" => "Elon",
  "EMU" => "Eastern Michigan",
  "ETAM" => "East Texas A&M",
  "ETNST" => "East Tennessee St.",
  "EVAN" => "Evansville",
  "EWU" => "Eastern Washington",
  "FAIR" => "Fairfield",
  "FAMU" => "Florida A&M",
  "FAU" => "Florida Atlantic",
  "FDU" => "Fairleigh Dickinson",
  "FGCU" => "Florida Gulf Coast",
  "FIU" => "FIU",
  "FLA" => "Florida",
  "FOR" => "Fordham",
  "FRES" => "Fresno St.",
  "FSU" => "Florida St.",
  "FUR" => "Furman",
  "GASO" => "Georgia Southern",
  "GAST" => "Georgia St.",
  "GCU" => "Grand Canyon",
  "GMU" => "George Mason",
  "GONZ" => "Gonzaga",
  "GRAM" => "Grambling St.",
  "GT" => "Georgia Tech",
  "GTWN" => "Georgetown",
  "GW" => "George Washington",
  "HAMP" => "Hampton",
  "HARV" => "Harvard",
  "HAW" => "Hawaii",
  "HC" => "Holy Cross",
  "HCU" => "Houston Christian",
  "HOF" => "Hofstra",
  "HOU" => "Houston",
  "HOW" => "Howard",
  "HP" => "High Point",
  "IDHO" => "Idaho",
  "IDST" => "Idaho St.",
  "ILL" => "Illinois",
  "ILST" => "Illinois St.",
  "IND" => "Indiana",
  "INST" => "Indiana St.",
  "IONA" => "Iona",
  "IOWA" => "Iowa",
  "ISU" => "Iowa St.",
  "IUI" => "IU Indy",
  "IW" => "Incarnate Word",
  "JAC" => "Jacksonville",
  "JKST" => "Jackson St.",
  "JMU" => "James Madison",
  "JVST" => "Jacksonville St.",
  "KENT" => "Kent St.",
  "KSU" => "Kansas St.",
  "KSW" => "Kennesaw St.",
  "KU" => "Kansas",
  "LA" => "Louisiana",
  "LAF" => "Lafayette",
  "LAM" => "Lamar",
  "LASAL" => "La Salle",
  "LBS" => "Long Beach St.",
  "LEH" => "Lehigh",
  "LIB" => "Liberty",
  "Linden" => "Lindenwood",
  "LIPS" => "Lipscomb",
  "LIU" => "LIU",
  "LMC" => "Le Moyne",
  "LONG" => "Longwood",
  "LOU" => "Louisville",
  "LOYIL" => "Loyola Chicago",
  "LOYMR" => "Loyola Marymount",
  "LSU" => "LSU",
  "LT" => "Louisiana Tech",
  "LUMD" => "Loyola MD",
  "M-OH" => "Miami OH",
  "MACK" => "Merrimack",
  "MANH" => "Manhattan",
  "MARQ" => "Marquette",
  "MCNS" => "McNeese",
  "MEM" => "Memphis",
  "MER" => "Mercer",
  "MHRT" => "Mercyhurst",
  "MIA" => "Miami FL",
  "MICH" => "Michigan",
  "MINN" => "Minnesota",
  "MISS" => "Mississippi",
  "MIZZ" => "Missouri",
  "MNE" => "Maine",
  "MOKC" => "Kansas City",
  "MONM" => "Monmouth",
  "MONT" => "Montana",
  "MORE" => "Morehead St.",
  "MORG" => "Morgan St.",
  "MOST" => "Missouri St.",
  "MRSH" => "Marshall",
  "MRST" => "Marist",
  "MSST" => "Mississippi St.",
  "MSU" => "Michigan St.",
  "MTST" => "Montana St.",
  "MTSTM" => "Mount St. Mary's",
  "MTSU" => "Middle Tennessee",
  "MURR" => "Murray St.",
  "MVSU" => "Mississippi Valley St.",
  "NA" => "North Alabama",
  "NAU" => "Northern Arizona",
  "NAVY" => "Navy",
  "NCAT" => "North Carolina A&T",
  "NCCU" => "North Carolina Central",
  "NCST" => "N.C. State",
  "ND" => "Notre Dame",
  "NDSU" => "North Dakota St.",
  "NEAS" => "Northeastern",
  "NEB" => "Nebraska",
  "NEOM" => "Nebraska Omaha",
  "NEV" => "Nevada",
  "NIAG" => "Niagara",
  "NICH" => "Nicholls",
  "NIU" => "Northern Illinois",
  "NJIT" => "NJIT",
  "NKU" => "Northern Kentucky",
  "NMSU" => "New Mexico St.",
  "NORF" => "Norfolk St.",
  "NOVA" => "Villanova",
  "NW" => "Northwestern",
  "NWST" => "Northwestern St.",
  "OAKD" => "Oakland",
  "ODU" => "Old Dominion",
  "OHIO" => "Ohio",
  "OKLA" => "Oklahoma",
  "OKST" => "Oklahoma St.",
  "ORAL" => "Oral Roberts",
  "ORE" => "Oregon",
  "ORST" => "Oregon St.",
  "OSU" => "Ohio St.",
  "PAC" => "Pacific",
  "PEAY" => "Austin Peay",
  "PENN" => "Penn",
  "PEPP" => "Pepperdine",
  "PFW" => "Purdue Fort Wayne",
  "PITT" => "Pittsburgh",
  "PORT" => "Portland",
  "PRES" => "Presbyterian",
  "PRIN" => "Princeton",
  "PROV" => "Providence",
  "PRST" => "Portland St.",
  "PSU" => "Penn St.",
  "PUR" => "Purdue",
  "PVAM" => "Prairie View A&M",
  "QNNC" => "Queens",
  "QPAC" => "Quinnipiac",
  "RADF" => "Radford",
  "RDER" => "Rider",
  "RICE" => "Rice",
  "RICH" => "Richmond",
  "RMU" => "Robert Morris",
  "RUTG" => "Rutgers",
  "SAC" => "Sacramento St.",
  "SAM" => "Samford",
  "SC" => "Santa Clara",
  "SCAR" => "South Carolina",
  "SCST" => "South Carolina St.",
  "SDAK" => "South Dakota",
  "SDKS" => "South Dakota St.",
  "SDSU" => "San Diego St.",
  "SELA" => "Southeastern Louisiana",
  "SEMO" => "Southeast Missouri",
  "SF" => "San Francisco",
  "SFA" => "Stephen F. Austin",
  "SFU" => "Saint Francis",
  "SH" => "Seton Hall",
  "SHSU" => "Sam Houston St.",
  "SHU" => "Sacred Heart",
  "SIEN" => "Siena",
  "SIU" => "Southern Illinois",
  "SIUE" => "SIUE",
  "SJPA" => "Saint Joseph's",
  "SJSU" => "San Jose St.",
  "SJU" => "St. John's",
  "SMU" => "SMU",
  "SOIN" => "Southern Indiana",
  "SOU" => "Southern",
  "STAN" => "Stanford",
  "STBON" => "St. Bonaventure",
  "STET" => "Stetson",
  "STLOU" => "Saint Louis",
  "STMCA" => "Saint Mary's",
  "STMN" => "St. Thomas",
  "STNH" => "Stonehill",
  "STON" => "Stony Brook",
  "STPE" => "Saint Peter's",
  "STTL" => "Seattle",
  "SUU" => "Southern Utah",
  "SYR" => "Syracuse",
  "TAMU" => "Texas A&M",
  "TAR" => "Tarleton St.",
  "TCU" => "TCU",
  "TEM" => "Temple",
  "TENN" => "Tennessee",
  "TEX" => "Texas",
  "TLSA" => "Tulsa",
  "TNST" => "Tennessee St.",
  "TNTC" => "Tennessee Tech",
  "TOL" => "Toledo",
  "TOWS" => "Towson",
  "TRGV" => "UT Rio Grande Valley",
  "TROY" => "Troy",
  "TTU" => "Texas Tech",
  "TULN" => "Tulane",
  "TXACC" => "Texas A&M Corpus Chris",
  "TXARL" => "UT Arlington",
  "TXSO" => "Texas Southern",
  "TXST" => "Texas St.",
  "UAB" => "UAB",
  "UALR" => "Little Rock",
  "UCA" => "Central Arkansas",
  "UCD" => "UC Davis",
  "UCF" => "UCF",
  "UCI" => "UC Irvine",
  "UCLA" => "UCLA",
  "UCSD" => "UC San Diego",
  "UGA" => "Georgia",
  "UIC" => "Illinois Chicago",
  "UK" => "Kentucky",
  "ULM" => "Louisiana Monroe",
  "UMASS" => "Massachusetts",
  "UMBC" => "UMBC",
  "UMD" => "Maryland",
  "UMES" => "Maryland Eastern Shore",
  "UMLW" => "UMass Lowell",
  "UNC" => "North Carolina",
  "UNCA" => "UNC Asheville",
  "UNCG" => "UNC Greensboro",
  "UNCO" => "Northern Colorado",
  "UNCW" => "UNC Wilmington",
  "UND" => "North Dakota",
  "UNFL" => "North Florida",
  "UNH" => "New Hampshire",
  "UNHV" => "New Haven",
  "UNI" => "Northern Iowa",
  "UNLV" => "UNLV",
  "UNM" => "New Mexico",
  "UNO" => "New Orleans",
  "UNT" => "North Texas",
  "URI" => "Rhode Island",
  "USA" => "South Alabama",
  "USC" => "USC",
  "USCU" => "USC Upstate",
  "USD" => "San Diego",
  "USF" => "South Florida",
  "USM" => "Southern Miss",
  "USU" => "Utah St.",
  "UTAH" => "Utah",
  "UTEP" => "UTEP",
  "UTM" => "Tennessee Martin",
  "UTSA" => "UTSA",
  "UTU" => "Utah Tech",
  "UVA" => "Virginia",
  "UVSU" => "Utah Valley",
  "UWGB" => "Green Bay",
  "UWM" => "Milwaukee",
  "VALP" => "Valparaiso",
  "VAN" => "Vanderbilt",
  "VCU" => "VCU",
  "VMI" => "VMI",
  "VRMT" => "Vermont",
  "VT" => "Virginia Tech",
  "WAG" => "Wagner",
  "WAKE" => "Wake Forest",
  "WASH" => "Washington",
  "WCHST" => "Wichita St.",
  "WCU" => "Western Carolina",
  "WEB" => "Weber St.",
  "WEBB" => "Gardner Webb",
  "WEGA" => "West Georgia",
  "WINT" => "Winthrop",
  "WIS" => "Wisconsin",
  "WIU" => "Western Illinois",
  "WKU" => "Western Kentucky",
  "WMRY" => "William & Mary",
  "WMU" => "Western Michigan",
  "WOF" => "Wofford",
  "WRIG" => "Wright St.",
  "WSU" => "Washington St.",
  "WVU" => "West Virginia",
  "WYO" => "Wyoming",
  "XAV" => "Xavier",
  "YALE" => "Yale",
  "YSU" => "Youngstown St."
}

overrides_by_league_and_source = {
  "mlb" => {
    "espn" => {
      "KCR" => "KC",
      "SDP" => "SD",
      "SFG" => "SF",
      "TBR" => "TB",
      "WSN" => "WSH",
    },
    "sportsline" => {
      "KCR" => "KC",
      "SDP" => "SD",
      "SFG" => "SF",
      "TBR" => "TB",
      "WSN" => "WAS"
    },
    "mlb_api" => {
      "ARI" => "AZ",
      "CHW" => "CWS",
      "KCR" => "KC",
      "SDP" => "SD",
      "SFG" => "SF",
      "TBR" => "TB",
      "WSN" => "WSH"
    },
    "roto_wire" => {
      "CHW" => "CWS",
      "KCR" => "KC",
      "SDP" => "SD",
      "SFG" => "SF",
      "TBR" => "TB",
      "WSN" => "WSH"
    }
    # fan_graphs has no overrides â€” all team codes match
  },
  "nfl" => {
    "espn" => {
      "GNB" => "GB",
      "KAN" => "KC",
      "LVR" => "LV",
      "NOR" => "NO",
      "NWE" => "NE",
      "SFO" => "SF",
      "TAM" => "TB",
      "WSH" => "WAS"
    },
    "sportsline" => {
      "GNB" => "GB",
      "JAX" => "JAC",
      "KAN" => "KC",
      "NOR" => "NO",
      "NWE" => "NE",
      "SFO" => "SF",
      "TAM" => "TB",
    }
  },
  "ncaaf" => {
    "sportsline" => shared_sportsline_overrides,
    "espn" => shared_espn_overrides
  },
  "ncaam" => {
    "sportsline" => shared_sportsline_overrides,
    "espn" => shared_espn_overrides,
    "barttorvik" => barttorvik_overrides,
    "ken_pom" => kenpom_overrides
  }
}

# Step 4: Seed team identifiers
overrides_by_league_and_source.each do |league_code, source_overrides|
  league = leagues.fetch(league_code)

  source_overrides.each do |source_code, team_overrides|
    source = sources.fetch(source_code)

    # Get teams for this league via the join table
    league_teams = league.teams

    league_teams.each do |team|
      internal_code = team.code
      external_code = team_overrides[internal_code] || internal_code

      ti = TeamIdentifier.find_or_initialize_by(
        team: team,
        league: league,
        data_source: source
      )
      ti.external_code = external_code
      ti.active = true
      ti.save!
    end
  end
end